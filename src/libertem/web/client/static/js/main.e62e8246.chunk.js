(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{262:function(e,t,n){e.exports=n.p+"static/media/LiberTEM logo-medium.7999e0dc.png"},272:function(e,t,n){e.exports=n(458)},458:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n(80),i=n(11),s=n(61),o=n(64),l=n(22),u=n(23),d=n(27),m=n(24),p=n(26),E=(n(280),n(468)),h=n(470),f=n(124),b=n(480),y=n(479),g=n(473),v=Object(i.b)(function(e){return{version:e.config.version,revision:e.config.revision}})(function(e){var t=e.version,n=e.revision;return r.createElement(r.Fragment,null,r.createElement(y.a,{as:"h3"},"This is LiberTEM version ",t," (revision ",n.slice(0,8),")"),r.createElement(g.a,null,r.createElement(g.a.Item,null,r.createElement(g.a.Icon,{name:"github"}),r.createElement(g.a.Content,null,"Find us on ",r.createElement("a",{href:"https://github.com/LiberTEM/LiberTEM"},"GitHub"))),r.createElement(g.a.Item,null,r.createElement(g.a.Icon,{name:"bug"}),r.createElement(g.a.Content,null,"Found a bug? Got a feature request? Please ",r.createElement("a",{href:"https://github.com/LiberTEM/LiberTEM/issues/new"},"open an issue!"))),r.createElement(g.a.Item,null,r.createElement(g.a.Icon,{name:"legal"}),r.createElement(g.a.Content,null,"LiberTEM is licensed under the ",r.createElement("a",{href:"https://github.com/LiberTEM/LiberTEM/blob/master/LICENSE"},"GNU General Public License v3.0"))),r.createElement(g.a.Item,null,r.createElement(g.a.Icon,{name:"book"}),r.createElement(g.a.Content,null,"Read ",r.createElement("a",{href:"https://libertem.github.io/LiberTEM/"},"the documentation"))),r.createElement(g.a.Item,null,r.createElement(g.a.Icon,{name:"user"}),r.createElement(g.a.Content,null,"Read ",r.createElement("a",{href:"https://libertem.github.io/LiberTEM/acknowledgments.html"},"the acknowledgments"))),r.createElement(g.a.Item,null,r.createElement(g.a.Icon,{name:"gitter"}),r.createElement(g.a.Content,null,"Join our ",r.createElement("a",{href:"https://gitter.im/LiberTEM/Lobby"},"chat on gitter!"))),r.createElement(g.a.Item,null,r.createElement(g.a.Icon,{name:"linkify"}),r.createElement(g.a.Content,null,r.createElement("a",{href:"https://doi.org/10.5281/zenodo.1478763"},r.createElement("img",{src:"https://zenodo.org/badge/DOI/10.5281/zenodo.1478763.svg",alt:"DOI"}))))))}),O=n(472),C=n(478);function x(e,t,n){return void 0===n&&void 0===t?{type:e}:void 0===n?{type:e,payload:t}:{type:e,payload:t,meta:n}}!function(e){e.NOT_CONNECTED="CLUSTER_NOT_CONNECTED",e.CONNECT="CLUSTER_CONNECT",e.CONNECTED="CLUSTER_CONNECTED"}(a||(a={}));var T={notConnected:function(){return x(a.NOT_CONNECTED)},connect:function(e){return x(a.CONNECT,{params:e})},connected:function(e){return x(a.CONNECTED,{params:e})}},R=n(129);function j(e){throw new Error(e)}function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return R.debounce(e,t,{maxWait:t})}function w(e){return Object.keys(e).filter(function(t){return"string"===typeof e[t]})}var A,_,I=n(42);!function(e){e.LOCAL="LOCAL",e.TCP="TCP"}(_||(_={}));var D,L,k,N=(A={},Object(I.a)(A,_.LOCAL,{label:"Create local cluster"}),Object(I.a)(A,_.TCP,{label:"Connect to cluster",helpText:"can be either local or remote, connection via TCP"}),A);!function(e){e.HDF5="HDF5",e.HDFS="HDFS",e.RAW="RAW",e.MIB="MIB",e.BLO="BLO",e.K2IS="K2IS"}(D||(D={})),function(e){e.OPEN="OPEN",e.OPENING="OPENING",e.DELETING="DELETING"}(L||(L={})),function(e){e.APPLY_RING_MASK="APPLY_RING_MASK",e.APPLY_DISK_MASK="APPLY_DISK_MASK",e.APPLY_POINT_SELECTOR="APPLY_POINT_SELECTOR",e.CENTER_OF_MASS="CENTER_OF_MASS",e.SUM_FRAMES="SUM_FRAMES",e.PICK_FRAME="PICK_FRAME"}(k||(k={}));var P,F=n(43),M=n(30),B=n(469),H=n(475),U=Object(M.a)({mapPropsToValues:function(e){return{numWorkers:e.config.localCores}},handleSubmit:function(e,t){(0,t.props.onSubmit)(Object(F.a)({type:_.LOCAL},e))}})(function(e){var t=e.values,n=e.touched,a=e.errors,c=(e.dirty,e.isSubmitting),i=e.handleChange,s=e.handleBlur,o=e.handleSubmit;e.handleReset;return r.createElement(B.a,{onSubmit:o},r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"numWorkers"},"Number of Workers:"),r.createElement("input",{type:"number",name:"numWorkers",value:t.numWorkers,onChange:i,onBlur:s}),a.numWorkers&&n.numWorkers&&a.numWorkers),r.createElement(H.a,{primary:!0,type:"submit",disabled:c},"Connect"))}),G=Object(M.a)({mapPropsToValues:function(){return{address:"tcp://localhost:8786"}},handleSubmit:function(e,t){(0,t.props.onSubmit)(Object(F.a)({type:_.TCP},e))}})(function(e){var t=e.values,n=e.touched,a=e.errors,c=(e.dirty,e.isSubmitting),i=e.handleChange,s=e.handleBlur,o=e.handleSubmit;e.handleReset;return r.createElement(B.a,{onSubmit:o},r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"address"},"Scheduler URI"),r.createElement("input",{type:"text",name:"address",value:t.address,onChange:i,onBlur:s}),a.address&&n.address&&a.address),r.createElement(H.a,{primary:!0,type:"submit",disabled:c},"Connect"))}),W={connectToCluster:T.connect},z=w(_).map(function(e){return{text:N[_[e]].label,value:_[e]}}),J=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={clusterType:_.LOCAL},n.setType=function(e){n.setState({clusterType:e})},n.handleChange=function(e,t){var a=t.value;n.setType(a)},n.handleSubmit=function(e){n.props.connectToCluster(e)},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"renderForm",value:function(){var e=this.state.clusterType,t=this.props.config;switch(e){case _.LOCAL:return r.createElement(U,{config:t,onSubmit:this.handleSubmit});case _.TCP:return r.createElement(G,{onSubmit:this.handleSubmit})}}},{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement(O.a,{inline:!0,options:z,value:this.state.clusterType,onChange:this.handleChange})),r.createElement(C.a,null,this.renderForm()))}}]),t}(r.Component),Y=Object(i.b)(function(e){return{config:e.config}},W)(J),K=n(474),V=function(e){var t=e.msg;return r.createElement(K.a,{icon:!0},r.createElement(f.a,{name:"cog",loading:!0}),r.createElement(K.a.Content,null,r.createElement(K.a.Header,null,"Connecting to LiberTEM"),t))},X={waiting:"Waiting...",connecting:"Connecting..."},q="Connected, waiting for initial state...",Z="Connected, fetching cluster status...",$=Object(i.b)(function(e){return{channelStatus:e.channelStatus,clusterConnection:e.clusterConnection}})(function(e){var t=e.children,n=e.channelStatus,a=e.clusterConnection;switch(n.status){case"waiting":case"connecting":return r.createElement(V,{msg:X[n.status]});case"connected":if("disconnected"===a.status)return r.createElement(Y,null);if("connected"===a.status)return r.createElement(V,{msg:q});if("unknown"===a.status)return r.createElement(V,{msg:Z})}return r.createElement(r.Fragment,null,t)});!function(e){e.LIST_DIRECTORY="BROWSER_LIST_DIRECTORY",e.LIST_FULL_PATH="BROWSER_LIST_DIRECTORY_FULL",e.DIRECTORY_LISTING="BROWSER_DIRECTORY_LISTING",e.DETECT_PARAMS="BROWSER_DETECT_PARAMS",e.PARAMS_DETECTED="BROWSER_PARAMS_DETECTED",e.ERROR="BROWSER_ERROR",e.OPEN="BROWSER_OPEN",e.CANCEL="BROWSER_CANCEL",e.SELECT="BROWSER_SELECT",e.SELECT_FULL_PATH="BROWSER_SELECT_FULL_PATH"}(P||(P={}));var Q={list:function(e,t){return x(P.LIST_DIRECTORY,{path:e,name:t})},dirListing:function(e,t,n,a,r){return x(P.DIRECTORY_LISTING,{path:e,dirs:t,files:n,drives:a,places:r})},open:function(){return x(P.OPEN)},cancel:function(){return x(P.CANCEL)},select:function(e,t){return x(P.SELECT,{path:e,name:t})},selectFullPath:function(e){return x(P.SELECT_FULL_PATH,{path:e})},error:function(e,t,n){return x(P.ERROR,{msg:e,timestamp:t,id:n})},detectParams:function(e){return x(P.DETECT_PARAMS,{path:e})},paramsDetected:function(e,t){return x(P.PARAMS_DETECTED,{path:e,params:t})}},ee=n(263),te=function(e){var t=e.ts,n=new Date(1e3*t),a=n.toLocaleDateString(),c=n.toLocaleTimeString(),i="".concat(a," ").concat(c);return r.createElement("div",{style:{display:"flex",whiteSpace:"nowrap"},title:i},r.createElement("div",{style:{width:"50%",marginRight:"10px"}},a),r.createElement("div",{style:{width:"45%"}},c))};var ne=function(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?1e3:1024;if(Math.abs(e)<n)return{size:e,unit:"B"};var a=t?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],r=-1;do{e/=n,++r}while(Math.abs(e)>=n&&r<a.length-1);return{size:e.toFixed(1),unit:a[r]}}(e.size,e.si);return r.createElement("div",{style:{textAlign:"right"}},t.size," ",t.unit)},ae=function(e){var t=e.children,n=e.title;return r.createElement("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",marginRight:"10px"},title:n},t)},re=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).onClick=function(e){var t=n.props.onClick;t&&t()},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.details,n=e.style,a=e.icon,c=Object(F.a)({cursor:"pointer"},n),i={textAlign:"right"};return r.createElement("div",{onClick:this.onClick,style:c},r.createElement("div",{style:{display:"flex",paddingRight:"10px"}},r.createElement("div",{style:{width:"20%",flexGrow:1}},r.createElement(ae,{title:t.name},a&&r.createElement(f.a,{name:a}),t.name)),r.createElement("div",{style:{width:"10%"}},r.createElement(ae,null,r.createElement(ne,{size:t.size,si:!1}))),r.createElement("div",{style:{width:"10%"}},r.createElement(ae,null,t.owner)),r.createElement("div",{style:Object(F.a)({width:"18%"},i)},r.createElement(ae,null,r.createElement(te,{ts:t.ctime}))),r.createElement("div",{style:Object(F.a)({width:"18%"},i)},r.createElement(ae,null,r.createElement(te,{ts:t.mtime})))))}}]),t}(r.Component),ce=function(){var e={textAlign:"right"};return r.createElement("div",{style:{paddingRight:"20px",paddingBottom:"10px"}},r.createElement("div",{style:{display:"flex"}},r.createElement("div",{style:{width:"20%",flexGrow:1}},r.createElement(ae,null,"Name")),r.createElement("div",{style:Object(F.a)({width:"10%"},e)},r.createElement(ae,null,"Size")),r.createElement("div",{style:{width:"10%"}},r.createElement(ae,null,"Owner")),r.createElement("div",{style:Object(F.a)({width:"18%"},e)},r.createElement(ae,null,"Created")),r.createElement("div",{style:Object(F.a)({width:"18%"},e)},r.createElement(ae,null,"Modified"))))},ie=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.details,n=e.style,a=e.select;return r.createElement(re,{onClick:a,style:n,details:t,icon:"file outline"})}}]),t}(r.Component),se=Object(i.b)(null,function(e,t){return{select:function(){return e(Q.select(t.path,t.details.name))}}})(ie),oe=Object(i.b)(null,function(e,t){return{list:function(){e(Q.list(t.path,t.details.name)),window.setTimeout(function(){return t.onChange()},0)}}})(function(e){var t=e.list,n=e.details,a=e.style;e.onChange;return r.createElement(re,{onClick:t,style:a,details:n,icon:"folder"})}),le=n(476),ue=n(133),de=Object(i.b)(null,function(e,t){return{list:function(){void 0!==t.value&&(e(Q.list(t.value.toString())),window.setTimeout(function(){return t.onChange()},0))}}})(function(e){var t=e.list,n=Object(ue.a)(e,["list"]),a=Object(F.a)({onClick:t},n);return r.createElement(O.a.Item,a)}),me=n(467),pe=Object(M.a)({mapPropsToValues:function(e){return{path:e.initialPath}},handleSubmit:function(e,t){(0,t.props.onChange)(e.path)},enableReinitialize:!0})(function(e){var t=e.values,n=(e.touched,e.errors,e.dirty,e.isSubmitting,e.handleChange),a=e.handleBlur,c=e.handleSubmit;e.handleReset;return r.createElement(B.a,{onSubmit:c,style:{flexGrow:1}},r.createElement(B.a.Field,null,r.createElement(me.a,{autoComplete:"off",onBlur:a,onChange:n,value:t.path,name:"path"})))}),Ee=Object(i.b)(function(e){return{lastOpened:e.config.lastOpened,fileHistory:e.config.fileHistory,separator:e.config.separator}},function(e){return{select:function(t){return e(Q.selectFullPath(t))}}})(function(e){var t=e.lastOpened,n=e.fileHistory,a=e.select,c=n.filter(function(e){return t[e]}).map(function(e){var n=t[e];return{text:n.path,value:{type:n.type,path:n.path}}}),i=function(e,t){return t.value&&a(t.value.toString())};return r.createElement(O.a,{item:!0,text:"Recent",floating:!0},r.createElement(O.a.Menu,null,r.createElement(O.a.Header,{content:"recent datasets"}),c.map(function(e,t){return r.createElement(O.a.Item,{key:t,value:e.value.path,content:e.text,onClick:i})})))}),he=Object(i.b)(null,function(e,t){return{refresh:function(){e(Q.list(t.currentPath)),window.setTimeout(function(){return t.onChange()},0)},handleInputChange:function(n){e(Q.list(n)),window.setTimeout(function(){return t.onChange()},0)},goUp:function(){e(Q.list(t.currentPath,"..")),window.setTimeout(function(){return t.onChange()},0)}}})(function(e){var t=e.currentPath,n=e.drives,a=e.places,c=e.onChange,i=e.refresh,s=e.goUp,o=e.handleInputChange,l=n.map(function(e){return{key:e,text:e}}),u=Object.keys(a).map(function(e){return{key:a[e].path,text:a[e].title}});return r.createElement(le.a,null,r.createElement(Ee,null),r.createElement(O.a,{text:"Go to...",floating:!0,item:!0},r.createElement(O.a.Menu,null,r.createElement(O.a.Header,{content:"Drives"}),l.map(function(e){return r.createElement(de,{key:e.key,value:e.key,content:e.text,onChange:c})}),r.createElement(O.a.Header,{content:"Places"}),u.map(function(e){return r.createElement(de,{key:e.key,value:e.key,content:e.text,onChange:c})}))),r.createElement(le.a.Item,{icon:"arrow up",onClick:s}),r.createElement(le.a.Item,{style:{flexGrow:1}},r.createElement(pe,{onChange:o,initialPath:t})),r.createElement(le.a.Item,{icon:"refresh",onClick:i}))}),fe=r.createRef(),be=function(){null!==fe.current&&fe.current.scrollToItem(0)};function ye(e,t){return e.sort(function(e,n){var a=t(e),r=t(n);return a<r?-1:a>r?1:0})}var ge=Object(i.b)(function(e){var t=e.browser;return{files:t.files,dirs:t.dirs,path:t.path,drives:t.drives,places:t.places,isLoading:t.isLoading}},function(e){return{cancel:function(){return e(Q.cancel())}}})(function(e){var t=e.files,n=e.dirs,a=e.path,c=e.drives,i=e.places,s=e.cancel,o=e.isLoading,l=function(e){return e.name.toLowerCase()},u=ye(n,l).map(function(e){return function(t){return r.createElement(oe,{style:t,onChange:be,path:a,details:e})}}),d=ye(t,l).map(function(e){return function(t){return r.createElement(se,{style:t,path:a,details:e})}}),m=u.concat(d),p=r.createElement(ee.a,{style:{overflowY:"scroll"},ref:fe,height:300,width:"100%",itemCount:m.length,itemSize:35},function(e){var t=e.index,n=e.style;return m[t](n)});return o&&(p=r.createElement(C.a,{loading:!0,style:{height:"300px"}})),r.createElement(C.a.Group,null,r.createElement(C.a,null,r.createElement(y.a,{as:"h2"},"Open dataset")),r.createElement(C.a,null,r.createElement(he,{currentPath:a,drives:c,places:i,onChange:be})),r.createElement(C.a,null,r.createElement(ce,null),p),r.createElement(C.a,null,r.createElement(H.a,{onClick:s},"Cancel")))}),ve={open:Q.open},Oe=Object(i.b)(function(e){return{isOpen:e.browser.isOpen}},ve)(function(e){var t=e.isOpen,n=e.open;return t?r.createElement(ge,null):r.createElement(H.a,{icon:!0,labelPosition:"left",onClick:n},r.createElement(f.a,{name:"add"}),"Browse")}),Ce=function(e,t){return function(n){return{x:Math.max(0,Math.min(e,n.x)),y:Math.max(0,Math.min(t,n.y))}}},xe=function(e,t,n){return function(a,r){return n&&n(function(e,t,n,a){var r=e-n,c=t-a;return Math.sqrt(r*r+c*c)}(e,t,a,r))}},Te=function(e){return function(t){return{x:t.x,y:e}}},Re=function(e,t){return function(n){return(a=e,function(e){return{x:a>e.x?a:e.x,y:e.y}})(Te(t)(n));var a}},je=function(e,t){return function(n){return(a=e,function(e){return{x:a<e.x?a:e.x,y:e.y}})(Te(t)(n));var a}},Se=n(96),we=function(e){var t=e.scale,n=e.x,a=e.y,c=e.withCross,i=Object(ue.a)(e,["scale","x","y","withCross"]),s={transform:"matrix(".concat(t,", 0, 0, ").concat(t,", ").concat(n-t*n,", ").concat(a-t*a,")"),stroke:"red",strokeWidth:1,fill:"transparent"},o="\n        M".concat(n-1.5," ").concat(a," L ").concat(n+1.5," ").concat(a,"\n        M").concat(n," ").concat(a-1.5," L ").concat(n," ").concat(a+1.5,"\n    "),l=c?r.createElement("path",{d:o,style:s}):null;return r.createElement("g",i,r.createElement("circle",{cx:n,cy:a,r:3,style:s}),l)};function Ae(e,t){var n=function(e){var t=e.ownerSVGElement;if(null===t)throw new Error("no owner SVG element?");var n=t.getAttribute("width");if(null===n)throw new Error("no width on SVG element?");var a=+n;return t.getBoundingClientRect().width/a}(t),a=t.getBoundingClientRect();return{x:(e.pageX-(a.left+window.scrollX))/n,y:(e.pageY-(a.top+window.scrollY))/n}}var _e,Ie=r.createRef(),De=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={dragging:!1,drag:{x:0,y:0}},n.externalMouseMove=function(e){n.move(e)},n.externalLeave=function(e){n.stopDrag(e)},n.externalMouseUp=function(e){n.stopDrag(e)},n.applyConstraint=function(e){var t=n.props.constraint;return t?t(e):e},n.startDrag=function(e){e.preventDefault();var t=n.props.parentOnDragStart;if(!Ie.current)throw new Error("startDrag without posRef");n.setState({dragging:!0,drag:n.applyConstraint(Ae(e,Ie.current))}),t&&t(Object(Se.a)(Object(Se.a)(n)))},n.move=function(e){var t=n.props.onDragMove;if(n.state.dragging){if(!Ie.current)throw new Error("move without posRef");n.setState({drag:n.applyConstraint(Ae(e,Ie.current))},function(){if(t){var e=n.applyConstraint(n.state.drag);t(e.x,e.y)}})}},n.stopDrag=function(e){var t=n.props.parentOnDrop,a=n.state,r=a.dragging,c=a.drag;r&&(n.setState({dragging:!1}),t&&t(c.x,c.y))},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"renderCommon",value:function(e,t){var n=this.props.imageWidth,a=void 0===n?1:n/128;return r.createElement("g",null,r.createElement("rect",{style:{visibility:"hidden"},ref:Ie,x:0,y:0,width:0,height:0}),r.createElement(we,{scale:a,x:e,y:t,withCross:this.props.withCross,onMouseUp:this.stopDrag,onMouseMove:this.move,onMouseDown:this.startDrag}))}},{key:"renderDragging",value:function(){var e=this.state.drag,t=e.x,n=e.y;return this.renderCommon(t,n)}},{key:"render",value:function(){var e=this.props,t=e.x,n=e.y;return this.state.dragging?this.renderDragging():this.renderCommon(t,n)}}]),t}(r.Component),Le=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).currentHandle=void 0,n.handleDragStart=function(e){n.currentHandle=e},n.handleDrop=function(){n.currentHandle=void 0},n.handleMouseMove=function(e){if(n.currentHandle)return n.currentHandle.externalMouseMove(e)},n.handleMouseLeave=function(e){n.currentHandle&&n.currentHandle.externalLeave(e)},n.handleMouseUp=function(e){n.currentHandle&&n.currentHandle.externalMouseUp(e)},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.width,n=e.height;return r.createElement("g",{onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onMouseUp:this.handleMouseUp,onKeyDown:this.props.onKeyboardEvent,style:{outline:"1px dashed black"},tabIndex:0},r.createElement("rect",{style:{fill:"transparent"},x:0,y:0,width:t,height:n}),this.renderChildren())}},{key:"renderChildren",value:function(){var e=this,t=this.props.children;return r.Children.map(t,function(t){if(!r.isValidElement(t))return t;var n={parentOnDragStart:e.handleDragStart,parentOnDrop:e.handleDrop};return r.cloneElement(t,n)})}}]),t}(r.Component),ke=function(e,t){var n=1;switch(e.shiftKey&&(n=10),e.key){case"ArrowUp":t(function(e,t){return{x:e,y:t-n}});break;case"ArrowDown":t(function(e,t){return{x:e,y:t+n}});break;case"ArrowLeft":t(function(e,t){return{x:e-n,y:t}});break;case"ArrowRight":t(function(e,t){return{x:e+n,y:t}});break;default:return}e.preventDefault()},Ne=function(e){return{fillOpacity:.3,fill:"red",strokeOpacity:.7,stroke:"red",strokeWidth:e/128/3}},Pe=function(e){var t=e.imageWidth,n=e.imageHeight,a=e.cx,c=e.cy,i=e.r,s=e.image,o=e.onCenterChange,l=e.onRChange,u={x:a-i,y:c};return r.createElement("svg",{style:{display:"block",border:"1px solid black",width:"100%",height:"auto"},width:t,height:n,viewBox:"0 0 ".concat(t," ").concat(n)},s,r.createElement("circle",{cx:a,cy:c,r:i,style:Object(F.a)({},Ne(t))}),r.createElement(Le,{width:t,height:n,onKeyboardEvent:function(e){ke(e,function(e){if(o){var t=e(a,c);o(t.x,t.y)}})}},r.createElement(De,{x:a,y:c,imageWidth:t,onDragMove:o,constraint:Ce(t,n)}),r.createElement(De,{x:u.x,y:u.y,imageWidth:t,onDragMove:xe(a,c,l),constraint:Te(c)})))};!function(e){e.CREATE="ANALYSIS_CREATE",e.CREATED="ANALYSIS_CREATED",e.UPDATE_PARAMETERS="ANALYSIS_UPDATE_PARAMETERS",e.RUN="ANALYSIS_RUN",e.RUNNING="ANALYSIS_RUNNING",e.REMOVE="ANALYSIS_REMOVE",e.REMOVED="ANALYSIS_REMOVED",e.ERROR="ANALYSIS_ERROR",e.SET_FRAMEVIEW_MODE="ANALYSIS_SET_FRAMEVIEW_MODE"}(_e||(_e={}));var Fe={create:function(e,t){return x(_e.CREATE,{dataset:e,analysisType:t})},created:function(e){return x(_e.CREATED,{analysis:e})},updateParameters:function(e,t,n){return x(_e.UPDATE_PARAMETERS,{id:e,kind:n,parameters:t})},setFrameViewMode:function(e,t,n){return x(_e.SET_FRAMEVIEW_MODE,{id:e,mode:t,initialParams:n})},run:function(e,t){return x(_e.RUN,{id:e,kind:t})},running:function(e,t,n){return x(_e.RUNNING,{id:e,job:t,kind:n})},remove:function(e){return x(_e.REMOVE,{id:e})},removed:function(e){return x(_e.REMOVED,{id:e})},error:function(e,t,n){return x(_e.ERROR,{msg:e,timestamp:t,id:n})}},Me=n(477),Be=function(){return r.createElement(f.a,{name:"cog",loading:!0,style:{margin:0,padding:0,position:"absolute",bottom:"10px",right:"10px",color:"white",opacity:.7,filter:"drop-shadow(0 0 3px #000)"}})},He=function(e){var t=e.children,n=e.busy;return r.createElement("div",{style:{position:"relative"}},t,n&&r.createElement(Be,null))},Ue=function(e){var t=e.job,n=e.idx,a=e.width,c=e.height,i=t.results[n];return void 0===i?r.createElement("svg",{style:{display:"block",border:"1px solid black",width:"100%",height:"auto"},width:a,height:c,viewBox:"0 0 ".concat(a," ").concat(c),key:-1}):r.createElement("image",{style:{width:"100%",height:"auto",imageRendering:"pixelated"},xlinkHref:i.imageURL,width:a,height:c})},Ge={updateParameters:Fe.updateParameters},We=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).onCenterChange=function(e,t){var a=n.props.analysis;if(a.frameDetails.type===k.PICK_FRAME){var r=a.frameDetails.parameters,c=Math.round(e),i=Math.round(t);r.x===c&&r.y===i||n.props.updateParameters(n.props.analysis.id,{x:c,y:i},"FRAME")}},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"renderPickHandles",value:function(){var e=this,t=this.props,n=t.analysis,a=t.width,c=t.height;if(n.frameDetails.type!==k.PICK_FRAME)return null;var i=n.frameDetails.parameters,s=i.x,o=i.y;return r.createElement(Le,{width:a,height:c,onKeyboardEvent:function(t){ke(t,function(t){var n=t(s,o);e.onCenterChange(n.x,n.y)})}},r.createElement(De,{x:s,y:o,withCross:!0,imageWidth:a,onDragMove:this.onCenterChange,constraint:Ce(a,c)}))}},{key:"render",value:function(){var e=this.props,t=e.job,n=e.idx,a=e.width,c=e.height,i="DONE"!==t.running;return r.createElement(He,{busy:i},r.createElement("svg",{style:{display:"block",border:"1px solid black",width:"100%",height:"auto"},width:a,height:c,viewBox:"0 0 ".concat(a," ").concat(c)},r.createElement(Ue,{job:t,idx:n,width:a,height:c}),this.renderPickHandles()))}}]),t}(r.Component),ze=Object(i.b)(null,Ge)(We),Je=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={selectedImg:0},n.selectImage=function(e,t){var a=t.value;n.setState({selectedImg:a})},n.getJob=function(){var e=n.props,t=e.currentJob,a=e.analysis,r=e.jobsById;if(t){if(t.results.length>0)return t;var c=a.jobHistory.RESULT;return c.length>0?r[c[0]]:void 0}},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e,t=this.props,n=t.analysis,a=t.dataset,c=t.width,i=t.height,s=t.pickCoords,o=r.createElement("svg",{style:{display:"block",border:"1px solid black",width:"100%",height:"auto"},width:c,height:i,viewBox:"0 0 ".concat(c," ").concat(i),key:-1}),l=this.getJob();if(l&&a)if(o=r.createElement(ze,{analysis:n,job:l,dataset:a,width:c,height:i,idx:this.state.selectedImg}),l.startTimestamp&&l.endTimestamp){var u=(l.endTimestamp-l.startTimestamp)/1e3;e=r.createElement(r.Fragment,null,"Analysis done in ",u.toFixed(3)," seconds")}else e=r.createElement(r.Fragment,null,"Analysis running...");else e=r.createElement(r.Fragment,null,"\xa0");return r.createElement("div",null,o,r.createElement(Ye,{job:l,handleChange:this.selectImage,selectedImg:this.state.selectedImg}),r.createElement("p",null,s," ",e))}}]),t}(r.Component),Ye=function(e){var t=e.job,n=e.handleChange,a=e.selectedImg;if(!t)return null;var c=t.results.map(function(e,t){return{text:e.description.title,value:t}});return r.createElement(r.Fragment,null,r.createElement("div",null,"Image:"," ",r.createElement(O.a,{inline:!0,options:c,value:a,onChange:n})))},Ke=Object(i.b)(function(e,t){var n=e.analyses.byId[t.analysis],a=n.jobs.RESULT,c=a?e.jobs.byId[a]:void 0,i=c?e.datasets.byId[c.dataset]:void 0,s=n.frameDetails.type===k.SUM_FRAMES?null:r.createElement(r.Fragment,null,"Pick: x=",n.frameDetails.parameters.x,", y=",n.frameDetails.parameters.y," \u2003");return{currentJob:c,jobsById:e.jobs.byId,analysis:n,dataset:i,pickCoords:s}})(Je),Ve=[{text:"Average",value:k.SUM_FRAMES},{text:"Pick",value:k.PICK_FRAME}],Xe={setFrameViewMode:Fe.setFrameViewMode},qe=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e,t){var a=t.value,r=n.props,c=r.analysis,i=r.scanWidth,s=r.scanHeight,o={};a===k.PICK_FRAME&&(o={x:Math.round(i/2),y:Math.round(s/2)}),n.props.setFrameViewMode(c.id,a,o)},n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props.analysis;return r.createElement(r.Fragment,null,r.createElement("div",null,"Mode:"," ",r.createElement(O.a,{inline:!0,options:Ve,value:e.frameDetails.type,onChange:this.handleChange})))}}]),t}(r.Component),Ze=Object(i.b)(function(e,t){var n=e.datasets.byId[t.analysis.dataset].params.shape;return{scanWidth:n[1],scanHeight:n[0]}},Xe)(qe),$e=function(e,t){var n=e.jobs.RESULT;return void 0===n?"idle":"DONE"!==t.byId[n].running?"busy":"idle"},Qe=Object(i.b)(function(e,t){return{status:$e(t.analysis,e.jobs)}},function(e,t){return{handleApply:function(){return e(Fe.run(t.analysis.id,"RESULT"))},handleRemove:function(){return e(Fe.remove(t.analysis.id))}}})(function(e){var t=e.status,n=(e.analysis,e.handleApply),a=e.handleRemove,c="busy"===t?{name:"cog",loading:!0}:{name:"check"};return r.createElement(C.a,{attached:"bottom"},r.createElement(H.a.Group,null,r.createElement(H.a,{primary:!0,onClick:n,icon:!0},r.createElement(f.a,c),"Apply"),r.createElement(H.a,{onClick:a,icon:!0},r.createElement(f.a,{name:"remove"}),"Remove")))}),et=function(e,t){var n=e.jobs.FRAME;if(void 0!==n)return t.byId[n]},tt=Object(i.b)(function(e,t){return{frameJob:et(t.analysis,e.jobs)}})(function(e){var t=e.frameJob,n=e.analysis,a=e.dataset,c=e.title,i=e.subtitle,s=e.children,o=a.params.shape,l=o[1],u=o[0],d=void 0!==t&&"DONE"!==t.running;return r.createElement(r.Fragment,null,r.createElement(y.a,{as:"h3",attached:"top"},r.createElement(f.a,{name:"cog"}),r.createElement(y.a.Content,null,c)),r.createElement(C.a,{attached:!0},r.createElement(Me.a,{columns:2},r.createElement(Me.a.Row,null,r.createElement(Me.a.Column,null,r.createElement(He,{busy:d},s),r.createElement(Ze,{analysis:n}),r.createElement("p",null,i)),r.createElement(Me.a.Column,null,r.createElement(Ke,{analysis:n.id,width:l,height:u}))))),r.createElement(Qe,{analysis:n}))}),nt=function(e,t){var n=e.jobs.FRAME;if(void 0!==n){var a=t.byId[n];if(a.results.length>0)return a;var r=e.jobHistory.FRAME,c=!0,i=!1,s=void 0;try{for(var o,l=r[Symbol.iterator]();!(c=(o=l.next()).done);c=!0){var u=o.value,d=t.byId[u];if(d.results.length>0)return d}}catch(m){i=!0,s=m}finally{try{c||null==l.return||l.return()}finally{if(i)throw s}}}},at=Object(i.b)(function(e,t){return{job:nt(t.analysis,e.jobs)}})(function(e){e.analysis;var t=e.dataset,n=e.job,a=t.params.shape,c=a[3],i=a[2];return void 0===n?null:r.createElement(Ue,{job:n,idx:0,width:c,height:i})}),rt=Object(i.b)(null,function(e,t){return{handleCenterChange:S(function(n,a){e(Fe.updateParameters(t.analysis.id,{cx:n,cy:a},"RESULT"))}),handleRChange:S(function(n){e(Fe.updateParameters(t.analysis.id,{r:n},"RESULT"))})}})(function(e){var t=e.parameters,n=e.analysis,a=e.dataset,c=e.handleRChange,i=e.handleCenterChange,s=a.params.shape,o=s[3],l=s[2],u=r.createElement(at,{dataset:a,analysis:n});return r.createElement(tt,{analysis:n,dataset:a,title:"COM analysis",subtitle:r.createElement(r.Fragment,null,"Disk: center=(x=",t.cx.toFixed(2),", y=",t.cy.toFixed(2),"), r=",t.r.toFixed(2))},r.createElement(Pe,{cx:t.cx,cy:t.cy,r:t.r,image:u,imageWidth:o,imageHeight:l,onCenterChange:i,onRChange:c}))}),ct=Object(i.b)(null,function(e,t){return{handleCenterChange:S(function(n,a){e(Fe.updateParameters(t.analysis.id,{cx:n,cy:a},"RESULT"))}),handleRChange:S(function(n){e(Fe.updateParameters(t.analysis.id,{r:n},"RESULT"))})}})(function(e){var t=e.parameters,n=e.analysis,a=e.dataset,c=e.handleRChange,i=e.handleCenterChange,s=a.params.shape,o=s[3],l=s[2],u=r.createElement(at,{dataset:a,analysis:n});return r.createElement(tt,{analysis:n,dataset:a,title:"Disk analysis",subtitle:r.createElement(r.Fragment,null,"Disk: center=(x=",t.cx.toFixed(2),", y=",t.cy.toFixed(2),"), r=",t.r.toFixed(2))},r.createElement(Pe,{cx:t.cx,cy:t.cy,r:t.r,image:u,imageWidth:o,imageHeight:l,onCenterChange:i,onRChange:c}))}),it=function(e){var t=e.imageWidth,n=e.imageHeight,a=e.cx,c=e.cy,i=e.image,s=e.onCenterChange;return r.createElement("svg",{style:{display:"block",border:"1px solid black",width:"100%",height:"auto"},width:t,height:n,viewBox:"0 0 ".concat(t," ").concat(n)},i,r.createElement(Le,{width:t,height:n,onKeyboardEvent:function(e){ke(e,function(e){if(s){var t=e(a,c);s(t.x,t.y)}})}},r.createElement(De,{x:a,y:c,withCross:!0,onDragMove:s,imageWidth:t,constraint:Ce(t,n)})))},st=Object(i.b)(null,function(e,t){return{handleCenterChange:S(function(n,a){e(Fe.updateParameters(t.analysis.id,{cx:n,cy:a},"RESULT"))})}})(function(e){var t=e.parameters,n=e.analysis,a=e.dataset,c=e.handleCenterChange,i=a.params.shape,s=i[3],o=i[2],l=r.createElement(at,{dataset:a,analysis:n});return r.createElement(tt,{analysis:n,dataset:a,title:"Point analysis",subtitle:r.createElement(r.Fragment,null,"Point: center=(x=",t.cx.toFixed(2),", y=",t.cy.toFixed(2),")")},r.createElement(it,{cx:t.cx,cy:t.cy,image:l,imageWidth:s,imageHeight:o,onCenterChange:c}))});function ot(e,t,n,a){n===t&&(n+=360);var r=n-t;r=r<0?r+360:r;var c=[];return c.push(lt(t,a,e)),c.push(lt(t+r/3,a,e)),c.push(lt(t+2*r/3,a,e)),c.push(lt(n,a,e)),function(e,t,n){return["M",e[0].x,e[0].y,"A",t,t,0,0,n,e[1].x,e[1].y,"A",t,t,0,0,n,e[2].x,e[2].y,"A",t,t,0,0,n,e[3].x,e[3].y].join(" ")}(c,a,r<180?0:1)}function lt(e,t,n){var a=e*Math.PI/180;return{x:Math.cos(a)*t+n.x,y:Math.sin(a)*t+n.y}}var ut,dt=function(e){var t=e.imageWidth,n=e.imageHeight,a=e.cx,c=e.cy,i=e.ri,s=e.ro,o=e.image,l=e.onCenterChange,u=e.onRIChange,d=e.onROChange,m={x:a-i,y:c},p={x:a-s,y:c},E=[ot({x:a,y:c},90,90,s),ot({x:a,y:c},90,90,i)].join(" ");return r.createElement("svg",{style:{display:"block",border:"1px solid black",width:"100%",height:"auto"},width:t,height:n,viewBox:"0 0 ".concat(t," ").concat(n)},o,r.createElement("path",{d:E,fillRule:"evenodd",style:Object(F.a)({},Ne(t))}),r.createElement(Le,{width:t,height:n,onKeyboardEvent:function(e){ke(e,function(e){if(l){var t=e(a,c);l(t.x,t.y)}})}},r.createElement(De,{x:a,y:c,imageWidth:t,onDragMove:l,constraint:Ce(t,n)}),r.createElement(De,{x:p.x,y:p.y,imageWidth:t,onDragMove:xe(a,c,d),constraint:je(m.x,c)}),r.createElement(De,{x:m.x,y:m.y,imageWidth:t,onDragMove:xe(a,c,u),constraint:Re(p.x,c)})))},mt=Object(i.b)(null,function(e,t){return{handleCenterChange:S(function(n,a){e(Fe.updateParameters(t.analysis.id,{cx:n,cy:a},"RESULT"))}),handleRIChange:S(function(n){e(Fe.updateParameters(t.analysis.id,{ri:n},"RESULT"))}),handleROChange:S(function(n){e(Fe.updateParameters(t.analysis.id,{ro:n},"RESULT"))})}})(function(e){var t=e.analysis,n=e.dataset,a=e.parameters,c=e.handleCenterChange,i=e.handleRIChange,s=e.handleROChange,o=n.params.shape,l=o[3],u=o[2],d=r.createElement(at,{dataset:n,analysis:t});return r.createElement(tt,{analysis:t,dataset:n,title:"Ring analysis",subtitle:r.createElement(r.Fragment,null,"Ring: center=(x=",a.cx.toFixed(2),", y=",a.cy.toFixed(2),"), ri=",a.ri.toFixed(2),", ro=",a.ro.toFixed(2))},r.createElement(dt,{cx:a.cx,cy:a.cy,ri:a.ri,ro:a.ro,imageWidth:l,imageHeight:u,image:d,onCenterChange:c,onRIChange:i,onROChange:s}))}),pt=Object(i.b)(function(e,t){return{dataset:e.datasets.byId[t.analysis.dataset]}})(function(e){var t=e.analysis,n=e.dataset;switch(t.resultDetails.type){case k.APPLY_DISK_MASK:return r.createElement(ct,{dataset:n,analysis:t,parameters:t.resultDetails.parameters});case k.APPLY_RING_MASK:return r.createElement(mt,{dataset:n,analysis:t,parameters:t.resultDetails.parameters});case k.CENTER_OF_MASS:return r.createElement(rt,{dataset:n,analysis:t,parameters:t.resultDetails.parameters});case k.APPLY_POINT_SELECTOR:return r.createElement(st,{dataset:n,analysis:t,parameters:t.resultDetails.parameters})}return j("unknown analysis type")}),Et=function(e){var t=e.analyses;return r.createElement(r.Fragment,null,t.ids.map(function(e){return r.createElement(pt,{key:e,analysis:t.byId[e]})}))},ht=n(53);function ft(e,t,n){var a=Object.assign({},e.byId[t],n),r=Object.assign({},e.byId,Object(I.a)({},t,a));return Object.assign({},e,{byId:r})}function bt(e,t,n){var a=Object.assign({},e.byId,Object(I.a)({},t,n)),r=[].concat(Object(ht.a)(e.ids),[t]);return Object.assign({},e,{byId:a,ids:r})}function yt(e,t){var n=e.ids.filter(function(n){return t(e.byId[n])}),a=n.reduce(function(t,n){return Object.assign(t,Object(I.a)({},n,e.byId[n]))},{});return Object.assign({},e,{byId:a,ids:n})}var gt,vt=(ut={},Object(I.a)(ut,k.APPLY_RING_MASK,{long:"Apply a ring mask with center cx, cy; inner radius ri, outer radius ro",short:"Ring",showInUI:!0}),Object(I.a)(ut,k.APPLY_DISK_MASK,{long:"Apply a disk mask with center cx, cy; radius r",short:"Disk",showInUI:!0}),Object(I.a)(ut,k.CENTER_OF_MASS,{long:"Compute the center of mass of all diffraction images",short:"Center of mass",showInUI:!0}),Object(I.a)(ut,k.APPLY_POINT_SELECTOR,{long:"Create an image from a single pixel selected in the detector",short:"Point selection",showInUI:!0}),Object(I.a)(ut,k.SUM_FRAMES,{long:"Create a sum of all detector frames",short:"Sum all frames",showInUI:!1}),Object(I.a)(ut,k.PICK_FRAME,{long:"Pick a single frame",short:"Pick frame",showInUI:!1}),ut),Ot=function(e){return vt[k[e]]},Ct=w(k).filter(function(e){return Ot(e).showInUI}).map(function(e){return{text:Ot(e).short,value:k[e]}}),xt=function(e){var t=e.onClick,n=e.label;return r.createElement(O.a,{text:n,icon:"add",floating:!0,labeled:!0,button:!0,className:"icon"},r.createElement(O.a.Menu,null,r.createElement(O.a.Header,{content:"implemented analyses"}),Ct.map(function(e){return r.createElement(O.a.Item,Object.assign({key:e.value,onClick:(n=t,function(e,t){return n(t.value)})},e));var n})))},Tt=Object(i.b)(null,function(e,t){return{handleAddAnalysis:function(n){e(Fe.create(t.dataset.id,n))}}})(function(e){var t=e.handleAddAnalysis;return r.createElement(xt,{onClick:t,label:"Add analysis"})}),Rt=n(471),jt=function(e){return Object.keys(e).map(function(t,n){return r.createElement(Rt.a.Row,{key:n},r.createElement(Rt.a.Cell,null,t),r.createElement(Rt.a.Cell,null,(a=e[t])instanceof Array?"(".concat(a.join(","),")"):a));var a})},St=function(e){var t=e.dataset;return r.createElement(Rt.a,null,r.createElement(Rt.a.Header,null,r.createElement(Rt.a.Row,null,r.createElement(Rt.a.HeaderCell,null,"Parameter"),r.createElement(Rt.a.HeaderCell,null,"Value"))),r.createElement(Rt.a.Body,null,jt(t.params)))},wt=function(e){var t=e.elem;return r.createElement(Rt.a.Row,null,r.createElement(Rt.a.Cell,null,t.name),r.createElement(Rt.a.Cell,null,function(e){return e.value instanceof Array?r.createElement(At,{diagnostics:e.value}):e.value}(t)))},At=function(e){var t=e.diagnostics;return 0===t.length?null:r.createElement(Rt.a,null,r.createElement(Rt.a.Header,null,r.createElement(Rt.a.Row,null,r.createElement(Rt.a.HeaderCell,null,"Name"),r.createElement(Rt.a.HeaderCell,null,"Value"))),r.createElement(Rt.a.Body,null,t.map(function(e,t){return r.createElement(wt,{elem:e,key:t})})))},_t=function(e){var t=e.dataset;return r.createElement(r.Fragment,null,r.createElement(St,{dataset:t}),r.createElement(At,{diagnostics:t.diagnostics}))};!function(e){e.OPEN="DATASET_OPEN",e.CANCEL_OPEN="DATASET_CANCEL_OPEN",e.CREATE="DATASET_CREATE",e.CREATED="DATASET_CREATED",e.ERROR="DATASET_ERROR",e.DELETE="DATASET_DELETE",e.DELETED="DATASET_DELETED",e.DETECT="DATASET_DETECT",e.DETECTED="DATASET_DETECTED",e.DETECT_FAILED="DATASET_DETECT_FAILED"}(gt||(gt={}));var It={open:function(e,t){return x(gt.OPEN,{path:e,initialParams:t})},cancelOpen:function(){return x(gt.CANCEL_OPEN)},create:function(e){return x(gt.CREATE,{dataset:e})},created:function(e){return x(gt.CREATED,{dataset:e})},error:function(e,t,n,a){return x(gt.ERROR,{dataset:e,msg:t,timestamp:n,id:a})},delete:function(e){return x(gt.DELETE,{dataset:e})},deleted:function(e){return x(gt.DELETED,{dataset:e})},detect:function(e){return x(gt.DETECT,{path:e})},detected:function(e,t){return x(gt.DETECTED,{path:e,params:t})},detectFailed:function(e){return x(gt.DETECT_FAILED,{path:e})}},Dt=Object(i.b)(null,function(e,t){return{handleRemoveDataset:function(){e(It.delete(t.dataset.id))}}})(function(e){e.dataset;var t=e.handleRemoveDataset;return r.createElement(r.Fragment,null,r.createElement(H.a,{icon:"remove",labelPosition:"left",onClick:t,content:"Close Dataset"}))}),Lt=Object(i.b)(function(e,t){return{analyses:yt(e.analyses,function(e){return e.dataset===t.dataset.id})}})(function(e){var t,n=e.dataset,a=e.analyses,c=(t={},Object(I.a)(t,L.OPENING,"Opening dataset ".concat(n.params.name)),Object(I.a)(t,L.DELETING,"Closing dataset ".concat(n.params.name)),t);return n.status===L.OPENING||n.status===L.DELETING?r.createElement(r.Fragment,null,r.createElement(y.a,{as:"h2",dividing:!0},n.params.name),r.createElement(K.a,{icon:!0},r.createElement(f.a,{name:"cog",loading:!0}),r.createElement(K.a.Content,null,r.createElement(K.a.Header,null,c[n.status])))):r.createElement(C.a.Group,{style:{marginTop:"3em",marginBottom:"3em"}},r.createElement(C.a.Group,{horizontal:!0},r.createElement(C.a,null,r.createElement(y.a,{as:"h2"},r.createElement(f.a,{name:"database"}),r.createElement(h.a,{trigger:r.createElement(y.a.Content,null,n.params.name," ",r.createElement(f.a,{name:"info circle",size:"small",link:!0}))},r.createElement(b.a.Header,null,n.params.type," Dataset ",n.params.name),r.createElement(b.a.Content,null,r.createElement(_t,{dataset:n}))))),r.createElement(C.a,{style:{flexShrink:1,flexGrow:0}},r.createElement(Dt,{dataset:n}))),a.ids.length>0?r.createElement(r.Fragment,null,r.createElement(C.a,null,r.createElement(Et,{analyses:a}))):null,r.createElement(C.a,{textAlign:"center"},r.createElement(Tt,{dataset:n})))}),kt=n(45),Nt=n.n(kt);function Pt(e){return e.split(",").map(function(e){return+e})}function Ft(e,t,n){return n?(n[e]?n[e]:t).toString():t}var Mt,Bt=Object(M.a)({mapPropsToValues:function(e){var t=e.initial;return{name:Ft("name","",t),tileshape:Ft("tileshape","1, 8, 128, 128",t)}},handleSubmit:function(e,t){var n=t.props;(0,n.onSubmit)({path:n.path,type:D.BLO,name:e.name,tileshape:Pt(e.tileshape)})}})(function(e){var t=e.values,n=e.touched,a=e.errors,c=(e.dirty,e.isSubmitting),i=e.handleChange,s=e.handleBlur,o=e.handleSubmit,l=(e.handleReset,e.onCancel);return r.createElement(B.a,{onSubmit:o},r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"name"},"Name:"),r.createElement("input",{type:"text",name:"name",value:t.name,onChange:i,onBlur:s}),a.name&&n.name&&a.name),r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"tileshape"},"Tileshape:"),r.createElement("input",{type:"text",name:"tileshape",value:t.tileshape,onChange:i,onBlur:s})),r.createElement(H.a,{primary:!0,type:"submit",disabled:c},"Load Dataset"),r.createElement(H.a,{type:"button",onClick:l},"Cancel"))}),Ht=w(D).map(function(e){return{text:D[e],value:D[e]}}),Ut=function(e){var t=e.currentType,n=e.onClick;return r.createElement(r.Fragment,null,r.createElement(O.a,{inline:!0,options:Ht,value:t,onChange:n}))},Gt=Object(M.a)({mapPropsToValues:function(e){var t=e.initial;return{name:Ft("name","",t),tileshape:Ft("tileshape","1, 8, 128, 128",t),ds_path:Ft("ds_path","",t)}},handleSubmit:function(e,t){var n=t.props;(0,n.onSubmit)({path:n.path,type:D.HDF5,name:e.name,ds_path:e.ds_path,tileshape:e.tileshape.split(",").map(function(e){return+e})})}})(function(e){var t=e.values,n=e.touched,a=e.errors,c=(e.dirty,e.isSubmitting),i=e.handleChange,s=e.handleBlur,o=e.handleSubmit,l=(e.handleReset,e.onCancel);return r.createElement(B.a,{onSubmit:o},r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"name"},"Name:"),r.createElement("input",{type:"text",name:"name",value:t.name,onChange:i,onBlur:s}),a.name&&n.name&&a.name),r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"ds_path"},"HDF5 Dataset Path:"),r.createElement("input",{type:"text",name:"ds_path",value:t.ds_path,onChange:i,onBlur:s})),r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"tileshape"},"Tileshape:"),r.createElement("input",{type:"text",name:"tileshape",value:t.tileshape,onChange:i,onBlur:s})),r.createElement(H.a,{primary:!0,type:"submit",disabled:c},"Load Dataset"),r.createElement(H.a,{onClick:l},"Cancel"))}),Wt=Object(M.a)({mapPropsToValues:function(e){var t=e.initial;return{name:Ft("name","",t),tileshape:Ft("tileshape","1, 8, 128, 128",t)}},handleSubmit:function(e,t){var n=t.props;(0,n.onSubmit)({path:n.path,type:D.HDFS,name:e.name,tileshape:e.tileshape.split(",").map(function(e){return+e})})}})(function(e){var t=e.values,n=e.touched,a=e.errors,c=(e.dirty,e.isSubmitting),i=e.handleChange,s=e.handleBlur,o=e.handleSubmit,l=(e.handleReset,e.onCancel);return r.createElement(B.a,{onSubmit:o},r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"name"},"Name:"),r.createElement("input",{type:"text",name:"name",value:t.name,onChange:i,onBlur:s}),a.name&&n.name&&a.name),r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"tileshape"},"Tileshape:"),r.createElement("input",{type:"text",name:"tileshape",value:t.tileshape,onChange:i,onBlur:s})),r.createElement(H.a,{primary:!0,type:"submit",disabled:c},"Load Dataset"),r.createElement(H.a,{type:"button",onClick:l},"Cancel"))}),zt=Object(M.a)({mapPropsToValues:function(e){var t=e.initial;return{name:Ft("name","",t),scan_size:Ft("scan_size","32, 32",t)}},handleSubmit:function(e,t){var n=t.props;(0,n.onSubmit)({path:n.path,type:D.K2IS,name:e.name,scan_size:Pt(e.scan_size)})}})(function(e){var t=e.values,n=e.touched,a=e.errors,c=(e.dirty,e.isSubmitting),i=e.handleChange,s=e.handleBlur,o=e.handleSubmit,l=(e.handleReset,e.onCancel);return r.createElement(B.a,{onSubmit:o},r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"name"},"Name:"),r.createElement("input",{type:"text",name:"name",value:t.name,onChange:i,onBlur:s}),a.name&&n.name&&a.name),r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"scan_size"},"Scan Size:"),r.createElement("input",{type:"text",name:"scan_size",value:t.scan_size,onChange:i,onBlur:s})),r.createElement(H.a,{primary:!0,type:"submit",disabled:c},"Load Dataset"),r.createElement(H.a,{type:"button",onClick:l},"Cancel"))}),Jt=Object(M.a)({mapPropsToValues:function(e){var t=e.initial;return{name:Ft("name","",t),tileshape:Ft("tileshape","1, 8, 256, 256",t),scan_size:Ft("scan_size","256, 256",t)}},handleSubmit:function(e,t){var n=t.props;(0,n.onSubmit)({path:n.path,type:D.MIB,name:e.name,tileshape:Pt(e.tileshape),scan_size:Pt(e.scan_size)})}})(function(e){var t=e.values,n=e.touched,a=e.errors,c=(e.dirty,e.isSubmitting),i=e.handleChange,s=e.handleBlur,o=e.handleSubmit,l=(e.handleReset,e.onCancel);return r.createElement(B.a,{onSubmit:o},r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"name"},"Name:"),r.createElement("input",{type:"text",name:"name",value:t.name,onChange:i,onBlur:s}),a.name&&n.name&&a.name),r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"tileshape"},"Tileshape:"),r.createElement("input",{type:"text",name:"tileshape",value:t.tileshape,onChange:i,onBlur:s})),r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"scan_size"},"Scan Size:"),r.createElement("input",{type:"text",name:"scan_size",value:t.scan_size,onChange:i,onBlur:s})),r.createElement(H.a,{primary:!0,type:"submit",disabled:c},"Load Dataset"),r.createElement(H.a,{type:"button",onClick:l},"Cancel"))}),Yt=Object(M.a)({mapPropsToValues:function(e){var t=e.initial;return{name:Ft("name","",t),tileshape:Ft("tileshape","1, 8, 128, 128",t),detector_size_raw:Ft("detector_size_raw","130, 128",t),crop_detector_to:Ft("crop_detector_to","128, 128",t),scan_size:Ft("scan_size","256, 256",t),dtype:Ft("dtype","float32",t)}},handleSubmit:function(e,t){var n=t.props;(0,n.onSubmit)({path:n.path,type:D.RAW,name:e.name,dtype:e.dtype,tileshape:Pt(e.tileshape),scan_size:Pt(e.scan_size),detector_size_raw:Pt(e.detector_size_raw),crop_detector_to:Pt(e.crop_detector_to)})}})(function(e){var t=e.values,n=e.touched,a=e.errors,c=(e.dirty,e.isSubmitting),i=e.handleChange,s=e.handleBlur,o=e.handleSubmit,l=(e.handleReset,e.onCancel);return r.createElement(B.a,{onSubmit:o},r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"name"},"Name:"),r.createElement("input",{type:"text",name:"name",value:t.name,onChange:i,onBlur:s}),a.name&&n.name&&a.name),r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"tileshape"},"Tileshape:"),r.createElement("input",{type:"text",name:"tileshape",value:t.tileshape,onChange:i,onBlur:s})),r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"scan_size"},"Scan Size:"),r.createElement("input",{type:"text",name:"scan_size",value:t.scan_size,onChange:i,onBlur:s})),r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"dtype"},"Datatype (uint16, uint32, float32, float64, >u2, ..., can be anything that is ",r.createElement("a",{href:"https://docs.scipy.org/doc/numpy-1.15.1/reference/arrays.dtypes.html"},"understood by numpy as a dtype"),"):"),r.createElement("input",{type:"text",name:"dtype",value:t.dtype,onChange:i,onBlur:s})),r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"detector_size_raw"},"Detector Size (as in the file):"),r.createElement("input",{type:"text",name:"detector_size_raw",value:t.detector_size_raw,onChange:i,onBlur:s})),r.createElement(B.a.Field,null,r.createElement("label",{htmlFor:"crop_detector_to"},"Detector Size Crop:"),r.createElement("input",{type:"text",name:"crop_detector_to",value:t.crop_detector_to,onChange:i,onBlur:s})),r.createElement(H.a,{primary:!0,type:"submit",disabled:c},"Load Dataset"),r.createElement(H.a,{type:"button",onClick:l},"Cancel"))}),Kt=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={datasetType:D.RAW},n.setDatasetType=function(e,t){var a=t.value;n.setState({datasetType:a})},void 0!==e.formInitial&&(n.state={datasetType:e.formInitial.type}),n}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.formPath,a=t.formInitial,c=t.createDataset,i=t.onCancel,s=this.state.datasetType,o=function(t){return r.createElement(C.a,null,"Type: ",r.createElement(Ut,{onClick:e.setDatasetType,currentType:s}),r.createElement(y.a,{as:"h2"},"Open: ",n),t)};switch(s){case D.HDF5:var l=a&&s===a.type?a:void 0;return o(r.createElement(Gt,{path:n,initial:l,onSubmit:c,onCancel:i}));case D.HDFS:var u=a&&s===a.type?a:void 0;return o(r.createElement(Wt,{path:n,initial:u,onSubmit:c,onCancel:i}));case D.RAW:var d=a&&s===a.type?a:void 0;return o(r.createElement(Yt,{path:n,initial:d,onSubmit:c,onCancel:i}));case D.MIB:var m=a&&s===a.type?a:void 0;return o(r.createElement(Jt,{path:n,initial:m,onSubmit:c,onCancel:i}));case D.BLO:var p=a&&s===a.type?a:void 0;return o(r.createElement(Bt,{path:n,initial:p,onSubmit:c,onCancel:i}));case D.K2IS:var E=a&&s===a.type?a:void 0;return o(r.createElement(zt,{path:n,initial:E,onSubmit:c,onCancel:i}))}}}]),t}(r.Component),Vt=Object(i.b)(function(e){return{formVisible:e.openDataset.formVisible,formPath:e.openDataset.formPath,formInitial:e.openDataset.formInitialParams}},function(e){return{createDataset:function(t){e(It.create({id:Nt()(),params:t}))},onCancel:function(){return e(It.cancelOpen())}}})(Kt),Xt=Object(i.b)(function(e){return{busy:e.openDataset.busy,path:e.openDataset.busyPath}})(function(e){var t=e.busy,n=e.path;return t?r.createElement(r.Fragment,null,r.createElement(y.a,{as:"h2",dividing:!0},"Loading..."),r.createElement(K.a,{icon:!0},r.createElement(f.a,{name:"cog",loading:!0}),r.createElement(K.a.Content,null,r.createElement(K.a.Header,null,"Detecting parameters for ",n)))):null}),qt=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.formVisible,n=e.datasets;return r.createElement(r.Fragment,null,n.ids.map(function(e){return r.createElement(Lt,{dataset:n.byId[e],key:e})}),r.createElement(Xt,null),t&&r.createElement(Vt,null),r.createElement(Oe,null))}}]),t}(r.Component),Zt=Object(i.b)(function(e){return{datasets:e.datasets,formVisible:e.openDataset.formVisible,formPath:e.openDataset.formPath}})(qt);(Mt||(Mt={})).DISMISS="ERROR_DISMISS";var $t=function(e){return x(Mt.DISMISS,{id:e})},Qt=Object(i.b)(null,function(e,t){return{dismiss:function(){return e($t(t.error.id))}}})(function(e){var t=e.dismiss,n=e.error;return r.createElement(K.a,{negative:!0,onDismiss:t},n.msg)}),en=Object(i.b)(function(e){return{errors:e.errors,clusterConnected:"connected"===e.clusterConnection.status,channelConnected:"connected"===e.channelStatus.status||"ready"===e.channelStatus.status}})(function(e){var t=e.errors,n=e.clusterConnected,a=e.channelConnected,c=t.ids.slice(Math.max(0,t.ids.length-3)),i=t.ids.length>0&&n&&a;return r.createElement(h.a,{open:i},c.map(function(e){return r.createElement(Qt,{error:t.byId[e],key:e})}))}),tn=n(262),nn=n.n(tn),an=function(e){function t(){return Object(l.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.createElement(E.a,{style:{margin:"5em 1em 5em 1em"}},r.createElement("div",{style:{display:"flex"}},r.createElement("img",{src:nn.a,width:"200",height:"46",alt:"LiberTEM",style:{marginBottom:"20px"}})," ",r.createElement(h.a,{trigger:r.createElement(f.a,{name:"info circle",link:!0,style:{alignSelf:"flex-start"}})},r.createElement(b.a.Header,null,"About LiberTEM"),r.createElement(b.a.Content,null,r.createElement(v,null)))),r.createElement(en,null),r.createElement($,null,r.createElement(Zt,null)))}}]),t}(r.Component),rn=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function cn(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var sn=n(10),on=n.n(sn),ln=n(7);function un(e,t,n){var a={job:{dataset:t,analysis:n}};return fetch("/api/jobs/".concat(e,"/"),{body:JSON.stringify(a),credentials:"same-origin",method:"PUT"}).then(function(e){return e.json()})}function dn(e){return fetch("/api/jobs/".concat(e,"/"),{method:"DELETE",credentials:"same-origin"}).then(function(e){return e.json()})}var mn=on.a.mark(xn),pn=on.a.mark(Tn),En=on.a.mark(Rn),hn=on.a.mark(jn),fn=on.a.mark(Sn),bn=on.a.mark(wn),yn=on.a.mark(An);function gn(e,t){var n=t.params.shape,a=n[3],r=n[2],c=Math.min(a,r);switch(e){case k.APPLY_DISK_MASK:return{type:e,parameters:{shape:"disk",cx:a/2,cy:r/2,r:c/2}};case k.APPLY_RING_MASK:return{type:e,parameters:{shape:"ring",cx:a/2,cy:r/2,ri:c/4,ro:c/2}};case k.CENTER_OF_MASS:return{type:e,parameters:{shape:"com",cx:a/2,cy:r/2,r:c/2}};case k.APPLY_POINT_SELECTOR:return{type:e,parameters:{shape:"point",cx:a/2,cy:a/2}};case k.SUM_FRAMES:return{type:k.SUM_FRAMES,parameters:{}};case k.PICK_FRAME:return{type:k.PICK_FRAME,parameters:{x:Math.round(a/2),y:Math.round(r/2)}}}return j("unhandeled analysis type")}function vn(e,t){return e.datasets.byId[t]}function On(e,t){return e.analyses.byId[t]}function Cn(e,t){return e.jobs.byId[t]}function xn(e){var t,n,a,r,c;return on.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,Object(ln.g)(vn,e.payload.dataset);case 3:return t=i.sent,n={id:Nt()(),dataset:e.payload.dataset,resultDetails:gn(e.payload.analysisType,t),frameDetails:{type:k.SUM_FRAMES,parameters:{}},jobs:{},jobHistory:{FRAME:[],RESULT:[]}},i.next=7,Object(ln.e)(Rn,n.id);case 7:return a=i.sent,i.next=10,Object(ln.f)(Fe.created(n));case 10:return i.next=12,Object(ln.f)(Fe.run(n.id,"FRAME"));case 12:return i.next=15,Object(ln.h)(_e.REMOVE);case 15:if(i.sent.payload.id!==n.id){i.next=19;break}return i.next=19,Object(ln.d)(a);case 19:i.next=12;break;case 21:i.next=29;break;case 23:return i.prev=23,i.t0=i.catch(0),r=Date.now(),c=Nt()(),i.next=29,Object(ln.f)(Fe.error("Error creating analysis: ".concat(i.t0.toString()),r,c));case 29:case"end":return i.stop()}},mn,this,[[0,23]])}function Tn(e,t){var n;return on.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(void 0!==(n=e.jobs[t])){a.next=5;break}return a.abrupt("return");case 5:return a.next=7,Object(ln.g)(Cn,n);case 7:if("DONE"===a.sent.running){a.next=11;break}return a.next=11,Object(ln.c)(dn,n);case 11:case"end":return a.stop()}},pn,this)}function Rn(e){var t,n,a,r,c,i,s,l,u;return on.a.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,Object(ln.a)(_e.RUN,o.b.sliding(1));case 2:t=d.sent;case 3:return d.prev=4,d.next=7,Object(ln.h)(t);case 7:if((n=d.sent).payload.id===e){d.next=10;break}return d.abrupt("continue",3);case 10:return d.next=12,Object(ln.g)(On,e);case 12:if(a=d.sent,r=n.payload.kind,void 0===(c=a.jobs[r])){d.next=22;break}return d.next=18,Object(ln.g)(Cn,c);case 18:if(!(i=d.sent)||"DONE"===i.running){d.next=22;break}return d.next=22,Object(ln.c)(dn,c);case 22:if(s=Nt()(),"FRAME"!==r){d.next=28;break}return d.next=26,Object(ln.c)(un,s,a.dataset,a.frameDetails);case 26:d.next=31;break;case 28:if("RESULT"!==r){d.next=31;break}return d.next=31,Object(ln.c)(un,s,a.dataset,a.resultDetails);case 31:return d.next=33,Object(ln.f)(Fe.running(a.id,s,r));case 33:d.next=41;break;case 35:return d.prev=35,d.t0=d.catch(4),l=Date.now(),u=Nt()(),d.next=41,Object(ln.f)(Fe.error("Error running analysis: ".concat(d.t0.toString()),l,u));case 41:d.next=3;break;case 43:case"end":return d.stop()}},En,this,[[4,35]])}function jn(e){return on.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(ln.f)(Fe.run(e.payload.id,"FRAME"));case 2:case"end":return t.stop()}},hn,this)}function Sn(e){return on.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("FRAME"!==e.payload.kind){t.next=3;break}return t.next=3,Object(ln.f)(Fe.run(e.payload.id,"FRAME"));case 3:case"end":return t.stop()}},fn,this)}function wn(e){var t;return on.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(ln.g)(On,e.payload.id);case 2:return t=n.sent,n.prev=3,n.next=6,Object(ln.c)(Tn,t,"RESULT");case 6:return n.next=8,Object(ln.c)(Tn,t,"FRAME");case 8:return n.prev=8,n.next=11,Object(ln.f)(Fe.removed(e.payload.id));case 11:return n.finish(8);case 12:case"end":return n.stop()}},bn,this,[[3,,8,12]])}function An(){return on.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ln.i)(_e.CREATE,xn);case 2:return e.next=4,Object(ln.i)(_e.REMOVE,wn);case 4:return e.next=6,Object(ln.i)(_e.SET_FRAMEVIEW_MODE,jn);case 6:return e.next=8,Object(ln.i)(_e.UPDATE_PARAMETERS,Sn);case 8:case"end":return e.stop()}},yn,this)}var _n="LiberTEM.config";function In(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var r;return(n=[(r=n[0],r.replace(new RegExp("".concat(R.escapeRegExp(e.separator),"$")),""))].concat(Object(ht.a)(n.slice(1)))).map(function(e){return e.trim()}).join(e.separator)}function Dn(e){var t=window.localStorage.getItem(_n);if(null===t)return kn(e);var n=JSON.parse(t),a=kn(e);return Object.assign(a,n)}function Ln(e){var t=["cwd","lastOpened","fileHistory"].reduce(function(t,n){return t[n]=e[n],t},{});window.localStorage.setItem(_n,JSON.stringify(t))}function kn(e){return Object.assign({},e,{lastOpened:{},fileHistory:[],cwd:"/"})}function Nn(e){var t="/api/browse/localfs/?path=".concat(e);return fetch(t,{method:"GET",credentials:"same-origin"}).then(function(e){return e.json()})}var Pn,Fn=on.a.mark(Un),Mn=on.a.mark(Gn),Bn=on.a.mark(Wn),Hn=on.a.mark(zn);function Un(){return on.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ln.e)(Gn);case 2:return e.next=4,Object(ln.e)(zn);case 4:case"end":return e.stop()}},Fn,this)}function Gn(){var e,t,n,a,r,c;return on.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=3,Object(ln.h)(P.LIST_DIRECTORY);case 3:return e=i.sent,t=e.payload,n=t.name,a=t.path,i.next=7,Object(ln.g)(function(e){return e.config});case 7:return r=i.sent,c=void 0!==n?In(r,a,n):a,i.next=11,Object(ln.e)(Wn,c);case 11:i.next=0;break;case 13:case"end":return i.stop()}},Mn,this)}function Wn(e){var t,n,a,r,c,i,s,o;return on.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,Object(ln.c)(Nn,e);case 3:if("ok"!==(t=l.sent).status){l.next=9;break}return l.next=7,Object(ln.f)(Q.dirListing(t.path,t.dirs,t.files,t.drives,t.places));case 7:l.next=20;break;case 9:if("error"!==t.status){l.next=20;break}return l.next=12,Object(ln.g)(function(e){return e.browser});case 12:return n=l.sent,a=Date.now(),r=Nt()(),c=t.alternative?t.alternative:n.places.home.path,l.next=18,Object(ln.f)(Q.error("Error browsing directory: ".concat(t.msg),a,r));case 18:return l.next=20,Object(ln.f)(Q.list(c));case 20:l.next=33;break;case 22:return l.prev=22,l.t0=l.catch(0),l.next=26,Object(ln.g)(function(e){return e.browser});case 26:return i=l.sent,s=Date.now(),o=Nt()(),l.next=31,Object(ln.f)(Q.error("Error browsing directory: ".concat(l.t0.toString()),s,o));case 31:return l.next=33,Object(ln.f)(Q.list(i.places.home.path));case 33:case"end":return l.stop()}},Bn,this,[[0,22]])}function zn(){var e;return on.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,Object(ln.h)(P.OPEN);case 3:return t.next=5,Object(ln.g)(function(e){return e.config});case 5:return e=t.sent,t.next=8,Object(ln.f)(Q.list(e.cwd));case 8:t.next=0;break;case 10:case"end":return t.stop()}},Hn,this)}!function(e){e.INITIAL_STATE="CHANNEL_INITIAL_STATE",e.START_JOB="CHANNEL_START_JOB",e.FINISH_JOB="CHANNEL_FINISH_JOB",e.TASK_RESULT="CHANNEL_TASK_RESULT",e.JOB_ERROR="CHANNEL_JOB_ERROR",e.OPEN="CHANNEL_OPEN",e.CLOSE="CHANNEL_CLOSE",e.ERROR="CHANNEL_ERROR"}(Pn||(Pn={}));var Jn,Yn={initialState:function(e,t,n){return x(Pn.INITIAL_STATE,{jobs:e,datasets:t,timestamp:n})},startJob:function(e,t,n){return x(Pn.START_JOB,{job:e,timestamp:n,dataset:t})},finishJob:function(e,t,n){return x(Pn.FINISH_JOB,{job:e,results:t,timestamp:n})},taskResult:function(e,t,n){return x(Pn.TASK_RESULT,{job:e,results:t,timestamp:n})},jobError:function(e,t,n,a){return x(Pn.JOB_ERROR,{job:e,msg:t,id:n,timestamp:a})},open:function(e){return x(Pn.OPEN,{timestamp:e})},close:function(e){return x(Pn.CLOSE,{timestamp:e})},error:function(e,t,n){return x(Pn.ERROR,{msg:e,timestamp:t,id:n})}};function Kn(e,t){return Object.assign({messageType:e},t)}!function(e){e.INITIAL_STATE="INITIAL_STATE",e.START_JOB="START_JOB",e.FINISH_JOB="FINISH_JOB",e.TASK_RESULT="TASK_RESULT",e.JOB_ERROR="JOB_ERROR",e.BINARY="BINARY",e.OPEN="OPEN",e.CLOSE="CLOSE",e.ERROR="ERROR",e.DELETE_DATASET="DELETE_DATASET"}(Jn||(Jn={}));var Vn={initialState:function(e,t){return Kn(Jn.INITIAL_STATE,{jobs:e,datasets:t})},startJob:function(e,t){return Kn(Jn.START_JOB,{job:e,dataset:t})},finishJob:function(e,t){return Kn(Jn.FINISH_JOB,{job:e,followup:t})},taskResult:function(e,t){return Kn(Jn.TASK_RESULT,{job:e,followup:t})},jobError:function(e,t){return Kn(Jn.JOB_ERROR,{job:e,msg:t})},binary:function(e){return Kn(Jn.BINARY,{objectURL:e})},open:function(){return Kn(Jn.OPEN,{})},close:function(){return Kn(Jn.CLOSE,{})},error:function(e){return Kn(Jn.ERROR,{msg:e})},deleteDataset:function(e){return Kn(Jn.DELETE_DATASET,{dataset:e})}},Xn=on.a.mark(ta),qn=on.a.mark(na),Zn=on.a.mark(aa),$n=on.a.mark(ra),Qn=on.a.mark(ca);function ea(){return Object(o.e)(function(e){function t(t){if(t.data instanceof Blob)e(Vn.binary(URL.createObjectURL(t.data)));else{var n=JSON.parse(t.data);e(n)}}function n(){e(Vn.open())}function a(){e(Vn.close()),e(o.a)}function r(t){e(Vn.error("Error in weboscket connection"))}var c=new WebSocket("ws://".concat(window.location.hostname,":").concat(window.location.port,"/api/events/"));return c.addEventListener("message",t),c.addEventListener("open",n),c.addEventListener("close",a),c.addEventListener("error",r),function(){c.removeEventListener("message",t),c.removeEventListener("open",n),c.removeEventListener("close",a),c.removeEventListener("error",r)}})}function ta(){var e;return on.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,Object(ln.c)(ea);case 3:return e=t.sent,t.next=6,Object(ln.e)(na,e);case 6:return t.next=8,Object(ln.h)([Pn.OPEN,Pn.CLOSE]);case 8:if(t.sent.type!==Pn.OPEN){t.next=12;break}return t.next=12,Object(ln.h)([Pn.CLOSE,Pn.ERROR]);case 12:return t.next=14,Object(o.d)(1e3);case 14:t.next=0;break;case 16:case"end":return t.stop()}},Xn,this)}function na(e){var t,n,a,r;return on.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:c.prev=0;case 1:return c.next=4,Object(ln.h)(e);case 4:t=c.sent,n=Date.now(),c.t0=t.messageType,c.next=c.t0===Jn.OPEN?9:c.t0===Jn.CLOSE?12:c.t0===Jn.ERROR?15:c.t0===Jn.INITIAL_STATE?19:c.t0===Jn.START_JOB?22:c.t0===Jn.FINISH_JOB?25:c.t0===Jn.TASK_RESULT?28:c.t0===Jn.DELETE_DATASET?31:c.t0===Jn.JOB_ERROR?34:37;break;case 9:return c.next=11,Object(ln.f)(Yn.open(n));case 11:return c.abrupt("break",37);case 12:return c.next=14,Object(ln.f)(Yn.close(n));case 14:return c.abrupt("break",37);case 15:return a=Nt()(),c.next=18,Object(ln.f)(Yn.error(t.msg,n,a));case 18:return c.abrupt("break",37);case 19:return c.next=21,Object(ln.f)(Yn.initialState(t.jobs,t.datasets,n));case 21:return c.abrupt("break",37);case 22:return c.next=24,Object(ln.f)(Yn.startJob(t.job,t.details.dataset,n));case 24:return c.abrupt("break",37);case 25:return c.next=27,Object(ln.c)(ca,t,e,n);case 27:return c.abrupt("break",37);case 28:return c.next=30,Object(ln.c)(ra,t,e,n);case 30:return c.abrupt("break",37);case 31:return c.next=33,Object(ln.f)(It.deleted(t.dataset));case 33:return c.abrupt("break",37);case 34:return r=Nt()(),c.next=37,Object(ln.f)(Yn.jobError(t.job,t.msg,r,n));case 37:c.next=1;break;case 39:return c.prev=39,c.finish(39);case 41:case"end":return c.stop()}},qn,this,[[0,,39,41]])}function aa(e,t){var n,a;return on.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:n=[];case 1:if(!(n.length<e)){r.next=8;break}return r.next=4,Object(ln.h)(t);case 4:a=r.sent,n.push(a),r.next=1;break;case 8:return r.abrupt("return",n);case 9:case"end":return r.stop()}},Zn,this)}function ra(e,t,n){var a,r;return on.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(ln.c)(aa,e.followup.numMessages,t);case 2:return a=c.sent,r=a.map(function(t,n){return{imageURL:t.objectURL,description:e.followup.descriptions[n]}}),c.next=6,Object(ln.f)(Yn.taskResult(e.job,r,n));case 6:case"end":return c.stop()}},$n,this)}function ca(e,t,n){var a,r;return on.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(ln.c)(aa,e.followup.numMessages,t);case 2:return a=c.sent,r=a.map(function(t,n){return{imageURL:t.objectURL,description:e.followup.descriptions[n]}}),c.next=6,Object(ln.f)(Yn.finishJob(e.job,r,n));case 6:case"end":return c.stop()}},Qn,this)}function ia(e){var t={connection:e};return fetch("/api/config/connection/",{body:JSON.stringify(t),credentials:"same-origin",method:"PUT"}).then(function(e){return e.json()})}function sa(){return fetch("/api/config/connection/",{method:"GET"}).then(function(e){return e.json()})}var oa,la=on.a.mark(pa),ua=on.a.mark(Ea),da=on.a.mark(ha),ma=on.a.mark(fa);function pa(e){var t;return on.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(ln.c)(ia,e.payload.params);case 2:return t=n.sent,n.next=5,Object(ln.c)(Ea,t);case 5:case"end":return n.stop()}},la,this)}function Ea(e){return on.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("ok"!==e.status){t.next=5;break}return t.next=3,Object(ln.f)(T.connected(e.connection.connection));case 3:t.next=7;break;case 5:return t.next=7,Object(ln.f)(T.notConnected());case 7:case"end":return t.stop()}},ua,this)}function ha(){var e;return on.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,Object(ln.h)(Pn.OPEN);case 3:return t.next=5,Object(ln.c)(sa);case 5:return e=t.sent,t.next=8,Object(ln.c)(Ea,e);case 8:t.next=0;break;case 10:case"end":return t.stop()}},da,this)}function fa(){return on.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ln.i)(a.CONNECT,pa);case 2:return e.next=4,Object(ln.b)([ha()]);case 4:case"end":return e.stop()}},ma,this)}!function(e){e.FETCHED="CONFIG_FETCHED",e.FETCH="CONFIG_FETCH",e.FETCH_FAILED="CONFIG_FETCH_FAILED"}(oa||(oa={}));var ba={fetch:function(){return x(oa.FETCH)},fetched:function(e){return x(oa.FETCHED,{config:e})},fetchFailed:function(e,t,n){return x(oa.FETCH_FAILED,{msg:e,timestamp:t,id:n})}};function ya(){return fetch("/api/config/",{method:"GET",credentials:"same-origin"}).then(function(e){return e.json()})}var ga=on.a.mark(Ta),va=on.a.mark(Ra),Oa=on.a.mark(ja),Ca=on.a.mark(Sa),xa=on.a.mark(wa);function Ta(){return on.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ln.i)(Pn.OPEN,Ra);case 2:case"end":return e.stop()}},ga,this)}function Ra(){var e,t;return on.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(ln.f)(ba.fetch());case 2:return n.next=4,Object(ln.c)(ya);case 4:return e=n.sent,n.prev=5,t=Dn(e.config),n.next=9,Object(ln.f)(ba.fetched(t));case 9:n.next=16;break;case 11:n.prev=11,n.t0=n.catch(5);try{window.localStorage.removeItem(_n)}catch(a){}return n.next=16,Object(ln.f)(ba.fetched(kn(e.config)));case 16:case"end":return n.stop()}},va,this,[[5,11]])}function ja(){return on.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Object(ln.h)([gt.CREATE,P.DIRECTORY_LISTING]);case 3:return e.next=5,Object(ln.g)(function(e){return e.config});case 5:Ln(e.sent),e.next=0;break;case 9:case"end":return e.stop()}},Oa,this)}function Sa(){var e,t;return on.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(ln.c)(Ra);case 3:n.next=11;break;case 5:return n.prev=5,n.t0=n.catch(0),e=Date.now(),t=Nt()(),n.next=11,Object(ln.f)(ba.fetchFailed("failed to fetch config: ".concat(n.t0.toString()),e,t));case 11:case"end":return n.stop()}},Ca,this,[[0,5]])}function wa(){return on.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ln.e)(Sa);case 2:return e.next=4,Object(ln.e)(Ta);case 4:return e.next=6,Object(ln.e)(ja);case 6:case"end":return e.stop()}},xa,this)}function Aa(e,t){return fetch("/api/datasets/".concat(e,"/"),{body:JSON.stringify(t),credentials:"same-origin",method:"PUT"}).then(function(e){return e.json()})}function _a(e){return fetch("/api/datasets/".concat(e,"/"),{credentials:"same-origin",method:"DELETE"}).then(function(e){return e.json()})}function Ia(e){return fetch("/api/datasets/detect/?path=".concat(e),{credentials:"same-origin",method:"GET"}).then(function(e){return e.json()})}var Da=on.a.mark(Ma),La=on.a.mark(Ba),ka=on.a.mark(Ha),Na=on.a.mark(Ua),Pa=on.a.mark(Ga),Fa=on.a.mark(Wa);function Ma(e){var t,n,a,r,c;return on.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,Object(ln.c)(Aa,e.payload.dataset.id,{dataset:e.payload.dataset});case 3:if("ok"!==(t=i.sent).status){i.next=9;break}return i.next=7,Object(ln.f)(It.created(t.details));case 7:i.next=14;break;case 9:if("error"!==t.status){i.next=14;break}return n=Date.now(),a=Nt()(),i.next=14,Object(ln.f)(It.error(t.dataset,t.msg,n,a));case 14:i.next=22;break;case 16:return i.prev=16,i.t0=i.catch(0),r=Date.now(),c=Nt()(),i.next=22,Object(ln.f)(It.error(e.payload.dataset.id,"Error loading dataset: ".concat(i.t0.toString()),r,c));case 22:case"end":return i.stop()}},Da,this,[[0,16]])}function Ba(e){var t,n;return on.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(ln.c)(_a,e.payload.dataset);case 3:a.next=11;break;case 5:return a.prev=5,a.t0=a.catch(0),t=Date.now(),n=Nt()(),a.next=11,Object(ln.f)(It.error(e.payload.dataset,"Error closing dataset: ".concat(a.t0.toString()),t,n));case 11:case"end":return a.stop()}},La,this,[[0,5]])}function Ha(e){var t,n,a;return on.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(ln.g)(function(e){return e.config});case 2:return t=r.sent,n=t.lastOpened[e],r.prev=5,r.next=8,Object(ln.f)(It.detect(e));case 8:return r.next=10,Object(ln.c)(Ia,e);case 10:if("ok"!==(a=r.sent).status){r.next=17;break}return n=a.datasetParams,r.next=15,Object(ln.f)(It.detected(e,a.datasetParams));case 15:r.next=19;break;case 17:return r.next=19,Object(ln.f)(It.detectFailed(e));case 19:r.next=25;break;case 21:return r.prev=21,r.t0=r.catch(5),r.next=25,Object(ln.f)(It.detectFailed(e));case 25:return r.next=27,Object(ln.f)(It.open(e,n));case 27:case"end":return r.stop()}},ka,this,[[5,21]])}function Ua(e){var t;return on.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload.path,n.next=3,Object(ln.c)(Ha,t);case 3:case"end":return n.stop()}},Na,this)}function Ga(e){var t,n;return on.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(ln.g)(function(e){return e.config});case 2:return t=a.sent,n=In(t,e.payload.path,e.payload.name),a.next=6,Object(ln.c)(Ha,n);case 6:case"end":return a.stop()}},Pa,this)}function Wa(){return on.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ln.i)(gt.CREATE,Ma);case 2:return e.next=4,Object(ln.i)(gt.DELETE,Ba);case 4:return e.next=6,Object(ln.i)(P.SELECT,Ga);case 6:return e.next=8,Object(ln.i)(P.SELECT_FULL_PATH,Ua);case 8:case"end":return e.stop()}},Fa,this)}var za=on.a.mark(Ja);function Ja(){return on.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ln.b)([wa(),ta(),An(),Wa(),fa(),Un()]);case 2:case"end":return e.stop()}},za,this)}var Ya={byId:{},ids:[]};var Ka,Va={isOpen:!1,isLoading:!0,path:"/",drives:[],places:{},files:[],dirs:[]};!function(e){e.CONNECTING="connecting",e.CONNECTED="connected",e.READY="ready",e.WAITING="waiting"}(Ka||(Ka={}));var Xa={status:Ka.WAITING};var qa={status:"unknown"};var Za={version:"",revision:"",localCores:0,cwd:"/",separator:"/",lastOpened:{},fileHistory:[]};var $a={byId:{},ids:[]};var Qa={busy:!1,busyPath:"",formVisible:!1,formPath:"/",formInitialParams:void 0};var er={byId:{},ids:[]};var tr={byId:{},ids:[]};var nr=Object(s.c)({analyses:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ya,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _e.CREATED:return bt(e,t.payload.analysis.id,t.payload.analysis);case _e.UPDATE_PARAMETERS:var n="FRAME"===t.payload.kind?"frameDetails":"resultDetails",a=e.byId[t.payload.id][n],r=Object.assign({},a,{parameters:Object.assign({},a.parameters,t.payload.parameters)});return"FRAME"===t.payload.kind?ft(e,t.payload.id,{frameDetails:r}):ft(e,t.payload.id,{resultDetails:r});case _e.RUNNING:var c=t.payload,i=c.kind,s=c.id,o=e.byId[s],l=o.jobs[i],u=o.jobHistory;void 0!==l&&(u=Object.assign({},u,Object(I.a)({},i,[l].concat(Object(ht.a)(u[i])))));var d=Object.assign({},o.jobs,Object(I.a)({},t.payload.kind,t.payload.job));return ft(e,t.payload.id,{jobs:d,jobHistory:u});case _e.REMOVED:return yt(e,function(e){return e.id!==t.payload.id});case _e.SET_FRAMEVIEW_MODE:var m=Object.assign({},e.byId[t.payload.id].frameDetails,{type:t.payload.mode,parameters:t.payload.initialParams});return ft(e,t.payload.id,{frameDetails:m});case gt.DELETE:return yt(e,function(e){return e.dataset!==t.payload.dataset})}return e},channelStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xa;switch((arguments.length>1?arguments[1]:void 0).type){case Pn.OPEN:return{status:Ka.CONNECTED};case Pn.INITIAL_STATE:return{status:Ka.READY};case Pn.CLOSE:return{status:Ka.WAITING}}return e},clusterConnection:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.NOT_CONNECTED:return{status:"disconnected"};case a.CONNECTED:return{status:"connected",params:t.payload.params}}return e},datasets:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$a,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case Pn.INITIAL_STATE:var r=a.payload.datasets.map(function(e){return{id:e.id,status:L.OPEN,params:e.params,diagnostics:e.diagnostics}});return{byId:(e=r,t=function(e){return e.id},e.reduce(function(e,n){return Object.assign(e,Object(I.a)({},t(n),n))},{})),ids:r.map(function(e){return e.id})};case gt.CREATE:var c=Object(F.a)({},a.payload.dataset,{status:L.OPENING});return bt(n,a.payload.dataset.id,c);case gt.CREATED:var i=Object(F.a)({},a.payload.dataset,{status:L.OPEN});return ft(n,a.payload.dataset.id,i);case gt.ERROR:return yt(n,function(e){return e.id!==a.payload.dataset});case gt.DELETE:return ft(n,a.payload.dataset,{status:L.DELETING});case gt.DELETED:return yt(n,function(e){return e.id!==a.payload.dataset})}return n},openDataset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case gt.OPEN:return Object(F.a)({},e,{formVisible:!0,formPath:t.payload.path,formInitialParams:t.payload.initialParams});case gt.CANCEL_OPEN:case gt.CREATE:return Object(F.a)({},e,{formVisible:!1});case gt.DETECT:return Object(F.a)({},e,{busyPath:t.payload.path,busy:!0});case gt.DETECTED:case gt.DETECT_FAILED:return Object(F.a)({},e,{busyPath:"",busy:!1})}return e},jobs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _e.RUNNING:return void 0===e.byId[t.payload.job]?bt(e,t.payload.job,{id:t.payload.job,results:[],running:"CREATING",status:"CREATING"}):e;case Pn.START_JOB:return bt(e,t.payload.job,{id:t.payload.job,dataset:t.payload.dataset,results:[],running:"RUNNING",status:"IN_PROGRESS",startTimestamp:t.payload.timestamp});case Pn.TASK_RESULT:return ft(e,t.payload.job,{results:t.payload.results});case Pn.FINISH_JOB:return ft(e,t.payload.job,{results:t.payload.results,running:"DONE",status:"SUCCESS",endTimestamp:t.payload.timestamp});case Pn.JOB_ERROR:return ft(e,t.payload.job,{running:"DONE",status:"ERROR",endTimestamp:t.payload.timestamp})}return e},errors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:er,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case P.ERROR:case gt.ERROR:case Pn.ERROR:case _e.ERROR:case Pn.JOB_ERROR:return bt(e,t.payload.id,{id:t.payload.id,msg:t.payload.msg,timestamp:t.payload.timestamp});case Pn.OPEN:return er;case Mt.DISMISS:return yt(e,function(e){return e.id!==t.payload.id})}return e},config:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Za,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case oa.FETCHED:return n.payload.config;case P.DIRECTORY_LISTING:return Object.assign({},t,{cwd:n.payload.path});case gt.CREATE:var a=Object.assign({},t.lastOpened,Object(I.a)({},n.payload.dataset.params.path,n.payload.dataset.params)),r=(e=[n.payload.dataset.params.path].concat(Object(ht.a)(t.fileHistory)),e.reduce(function(e,t){return-1===e.indexOf(t)?[].concat(Object(ht.a)(e),[t]):e},[])).slice(0,11);return Object.assign({},t,{lastOpened:a,fileHistory:r})}return t},browser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Va,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case oa.FETCHED:return Object.assign({},e,{path:t.payload.config.cwd});case P.OPEN:return Object.assign({},e,{isOpen:!0});case P.CANCEL:return Object.assign({},e,{isOpen:!1});case P.LIST_DIRECTORY:return Object.assign({},e,{isLoading:!0});case P.DIRECTORY_LISTING:var n=t.payload.places.reduce(function(e,t){return Object.assign({},e,Object(I.a)({},t.key,t))},{});return Object.assign({},e,{isLoading:!1,path:t.payload.path,files:t.payload.files,dirs:t.payload.dirs,drives:t.payload.drives,places:n});case P.SELECT_FULL_PATH:case P.SELECT:return Object.assign({},e,{isLoading:!1,isOpen:!1})}return e}}),ar=Object(o.c)(),rr=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||s.d,cr=Object(s.e)(nr,rr(Object(s.a)(ar)));c.render(r.createElement(i.a,{store:cr},r.createElement(an,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/static",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/static","/service-worker.js");rn?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):cn(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):cn(e)})}}(),ar.run(Ja)}},[[272,2,1]]]);
//# sourceMappingURL=main.e62e8246.chunk.js.map